<?xml version='1.0' encoding='utf-8'?>

<tool id="clodius" name="clodius" version="0.0.1">
    <description>Clodius is a tool for breaking up large data sets into smaller tiles that can subsequently be displayed using an appropriate viewer.</description>
     <requirements>
        <requirement type="package" version="0.3.2">pybigwig</requirement>
        <requirement type="package" version="0.2.19">negspy</requirement>
        <requirement type="package" version="1.0.7">slugid</requirement>
        <requirement type="package" version="0.6.5">clodius</requirement>
    </requirements>
    <command>
    <![CDATA[
        clodius aggregate $file_type $input_file --assembly $assembly
        #if $file_type == "bedpe":
            --chr1-col 1
            --from1-col 2
            --to1-col 3
            --chr2-col 1
            --from2-col 2
            --to2-col 3
        #if $file_type == "bedfile":
            --max-per-tile 20
            --importance-column 5
            --delimiter '\t'
        #if $file_type == "bedgraph":
            --chromosome-col 2
            --from-pos-col 3
            --to-pos-col 4
            --value-col 5
            --has-header
            --nan-value 'NA'
    ]]>
    </command>
    <inputs>
        <param name="input_file" type="data" label="File to be aggregated"/>
        <param name="file_type" type="text" label="Filetype to be aggregated">
            <option value="bedpe">Bedpe-like file</option>
            <option value="bedfile">Gene Annotation File</option>
            <option value="bedgraph">BedGraph file</option>
            <option value="bigwig">BigWig File</option>
        </param>
        <param name="assembly" type="text" label="Genome Assembly">
            <option value="hg19">Human</option>
        </param>
    </inputs>
    <outputs>
        <data name="output_file">
            <filter>file_type == "bedpe"</filter>
        </data>
        <data name="output_file">
            <filter>file_type == "bedfile"</filter>
        </data>
        <data name="output_file">
            <filter>file_type == "bedgraph"</filter>
        </data>
        <data name="output_file">
            <filter>file_type == "bigwig"</filter>
        </data>
    </outputs>
   
    <tests>
        <test>
          <param name="input_file" value="test.txt" />
          <param name="file_type" value="bedpe" />
          <param name="assembly" value="hg19" />
          <output name="output_file" file="test.txt.multires" />     
        </test>
        <test>
          <param name="input_file" value="test.bed" />
          <param name="file_type" value="bedfile" />
          <param name="assembly" value="hg19" />
          <output name="output_file" file="test.mulitres.bed" />     
        </test>
        <test>
          <param name="input_file" value="test.tsv" />
          <param name="file_type" value="bedgraph" />
          <param name="assembly" value="hg19" />
          <output name="output_file" file="test.hitile" />     
        </test>
         <test>
          <param name="input_file" value="test.bw" />
          <param name="file_type" value="bigwig" />
          <param name="assembly" value="hg19" />
          <output name="output_file" file="test.multires.bw" lines_diff="9"/>     
        </test>
    </tests>
    <help>
<![CDATA[
**What it does**
Clodius is a tool for breaking up large data sets into smaller tiles that can subsequently be displayed using an appropriate viewer.
]]>
    </help>
</tool>
